<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cotizador Dinámico - Edificio Gibraltar</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800;900;950&display=swap" rel="stylesheet">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        body { 
            font-family: 'Inter', sans-serif; 
            background-color: #F3F4F6; 
            color: #333; 
        }
        .app-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }
        .content-card {
            background-color: white;
            border-radius: 1rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05), 0 4px 6px -2px rgba(0, 0, 0, 0.03);
            padding: 2rem;
        }
        .accent-color { color: #D4AF37; } /* Dorado Sutil */
        .bg-accent-light { background-color: #FEFCE8; } /* Fondo muy claro para destacar */
        
        .section-title {
            font-weight: 900;
            color: #1F2937;
            padding: 0.5rem 0;
            margin-bottom: 1.5rem;
            border-bottom: 3px solid #D4AF37;
        }

        .category-button {
            transition: all 0.2s ease;
        }
        .category-button:hover {
            background-color: #D4AF37;
            color: white;
        }
        .category-button.active {
            background-color: #D4AF37;
            color: white;
            box-shadow: 0 4px 6px -1px rgba(212, 175, 55, 0.5);
        }

        /* Estilo para los elementos de selección */
        .selectable-item {
            cursor: pointer;
            transition: background-color 0.15s;
            border-radius: 0.5rem;
        }
        .selectable-item:hover {
            background-color: #F9FAFB;
        }
        .selectable-item input[type="radio"]:checked + label,
        .selectable-item input[type="checkbox"]:checked + label {
            border: 2px solid #D4AF37;
            background-color: #FFFBEB; /* Fondo amarillo muy suave */
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="app-container grid grid-cols-1 lg:grid-cols-4 gap-8">
        
        <!-- COLUMNA PRINCIPAL (Selección de Servicios) -->
        <div class="lg:col-span-3 space-y-8">
            
            <!-- HEADER / NAVEGACIÓN -->
            <header class="bg-white p-6 rounded-xl shadow-md sticky top-0 z-10">
                <div class="flex justify-between items-center mb-4 border-b pb-4">
                    <h1 class="text-2xl font-black text-gray-800 flex items-center">
                        <span class="text-3xl font-extrabold accent-color mr-2">G</span>
                        COTIZADOR EDIFICIO GIBRALTAR
                    </h1>
                    <p class="text-sm text-gray-500 font-semibold">Tarifario 2025</p>
                </div>
                
                <!-- Botones de Navegación Rápida -->
                <div class="flex flex-wrap gap-3">
                    <button onclick="scrollToSection('definicion')" class="category-button px-4 py-2 bg-gray-200 text-gray-800 text-sm font-semibold rounded-full flex items-center">
                        <i data-lucide="edit" class="w-4 h-4 mr-2"></i>
                        Definición
                    </button>
                    <button onclick="scrollToSection('arriendo')" class="category-button px-4 py-2 bg-gray-200 text-gray-800 text-sm font-semibold rounded-full flex items-center">
                        <i data-lucide="building" class="w-4 h-4 mr-2"></i>
                        Arriendo Principal
                    </button>
                    <button onclick="scrollToSection('sesiones')" class="category-button px-4 py-2 bg-gray-200 text-gray-800 text-sm font-semibold rounded-full flex items-center">
                        <i data-lucide="camera" class="w-4 h-4 mr-2"></i>
                        Sesiones
                    </button>
                    <button onclick="scrollToSection('staff')" class="category-button px-4 py-2 bg-gray-200 text-gray-800 text-sm font-semibold rounded-full flex items-center">
                        <i data-lucide="users-2" class="w-4 h-4 mr-2"></i>
                        Staff Operativo
                    </button>
                    <button onclick="scrollToSection('tecnicos')" class="category-button px-4 py-2 bg-gray-200 text-gray-800 text-sm font-semibold rounded-full flex items-center">
                        <i data-lucide="zap" class="w-4 h-4 mr-2"></i>
                        Servicios Técnicos
                    </button>
                </div>
            </header>
            
            <!-- NUEVA SECCIÓN I: DEFINICIÓN DEL EVENTO -->
            <section id="definicion" class="content-card">
                <h2 class="text-2xl section-title">I. Define tu Evento y Características</h2>
                <p class="text-gray-600 mb-4">Ingrese los datos base de su evento para generar una idea inicial y adaptar su cotización.</p>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 p-4 bg-blue-50 rounded-lg border border-blue-200">
                    
                    <!-- Nombre del Evento -->
                    <div>
                        <label for="event_name" class="block text-sm font-bold text-gray-700 mb-1">Nombre del Proyecto / Evento</label>
                        <input type="text" id="event_name" value="" placeholder="Ej: Lanzamiento Producto X" class="w-full p-3 border border-blue-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-150">
                    </div>

                    <!-- Tipo de Evento -->
                    <div>
                        <label for="event_type" class="block text-sm font-bold text-gray-700 mb-1">Tipo de Evento</label>
                        <select id="event_type" class="w-full p-3 border border-blue-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-150 bg-white">
                            <option value="No Seleccionado" selected>Seleccione el tipo</option>
                            <option value="Conferencia / Seminario">Conferencia / Seminario</option>
                            <option value="Cóctel / Recepción">Cóctel / Recepción</option>
                            <option value="Fiesta / After Office">Fiesta / After Office</option>
                            <option value="Sesión Fotográfica / Grabación">Sesión Fotográfica / Grabación</option>
                            <option value="Presentación de Producto">Presentación de Producto / Lanzamiento</option>
                            <option value="Otro">Otro</option>
                        </select>
                    </div>

                    <!-- Cantidad de Asistentes -->
                    <div>
                        <label for="attendees" class="block text-sm font-bold text-gray-700 mb-1">Asistentes Estimados (Máx. 400)</label>
                        <input type="number" id="attendees" min="1" max="400" value="" placeholder="Ej: 150" class="w-full p-3 border border-blue-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-150">
                    </div>

                    <!-- Duración Estimada -->
                    <div>
                        <label for="duration" class="block text-sm font-bold text-gray-700 mb-1">Duración Estimada del Evento (Horas)</label>
                        <input type="number" id="duration" min="2" max="12" value="4" class="w-full p-3 border border-blue-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-150">
                    </div>

                </div>
            </section>
            
            <!-- SECCIÓN II: ARRIENDO DE ESPACIOS (Radio Buttons - Excluyentes) -->
            <section id="arriendo" class="content-card">
                <h2 class="text-2xl section-title">II. Arriendo de Espacios Corporativos</h2>
                <p class="text-gray-600 mb-4">Seleccione la locación principal requerida. **Solo puede seleccionar una opción de arriendo (evento o sesión fotográfica/grabación).**</p>
                
                <div class="space-y-4">

                    <!-- GRUPO ARRIENDO EVENTO -->
                    <div class="p-4 bg-gray-50 rounded-lg border border-gray-200">
                        <h3 class="font-black text-lg mb-3 flex items-center text-blue-700">
                             <i data-lucide="chevrons-down" class="w-5 h-5 mr-2"></i> Arriendo Evento (-1 y -6)
                        </h3>
                        <!-- Opción 1: Arriendo -1 (Mié-Vie) -->
                        <div class="selectable-item flex items-center p-3">
                            <input id="arriendo_1" type="radio" name="arriendo" value="3500000" class="text-blue-600 focus:ring-blue-500 mr-3 w-5 h-5" onchange="calculateTotal()">
                            <label for="arriendo_1" class="w-full font-semibold text-gray-800 p-2 border border-transparent rounded-lg flex justify-between items-center">
                                <span class="flex-1">PISO -1: Tarima y Piletas (Mié-Vie)</span>
                                <span class="text-lg font-extrabold text-red-600">$3.500.000</span>
                            </label>
                        </div>
                        <!-- Opción 2: Arriendo -1 (Sáb-Mar) -->
                        <div class="selectable-item flex items-center p-3">
                            <input id="arriendo_2" type="radio" name="arriendo" value="3000000" class="text-blue-600 focus:ring-blue-500 mr-3 w-5 h-5" onchange="calculateTotal()">
                            <label for="arriendo_2" class="w-full font-semibold text-gray-800 p-2 border border-transparent rounded-lg flex justify-between items-center">
                                <span class="flex-1">PISO -1: Tarima y Piletas (Sáb-Mar)</span>
                                <span class="text-lg font-extrabold text-green-600">$3.000.000</span>
                            </label>
                        </div>
                         <!-- Opción 3: Arriendo -6 (Mié-Sáb) -->
                        <div class="selectable-item flex items-center p-3">
                            <input id="arriendo_3" type="radio" name="arriendo" value="1500000" class="text-blue-600 focus:ring-blue-500 mr-3 w-5 h-5" onchange="calculateTotal()">
                            <label for="arriendo_3" class="w-full font-semibold text-gray-800 p-2 border border-transparent rounded-lg flex justify-between items-center">
                                <span class="flex-1">PISO -6: Club Privado (Mié-Sáb)</span>
                                <span class="text-lg font-extrabold text-red-600">$1.500.000</span>
                            </label>
                        </div>
                        <!-- Opción 4: Arriendo -6 (Dom-Mar) -->
                        <div class="selectable-item flex items-center p-3">
                            <input id="arriendo_4" type="radio" name="arriendo" value="1000000" class="text-blue-600 focus:ring-blue-500 mr-3 w-5 h-5" onchange="calculateTotal()">
                            <label for="arriendo_4" class="w-full font-semibold text-gray-800 p-2 border border-transparent rounded-lg flex justify-between items-center">
                                <span class="flex-1">PISO -6: Club Privado (Dom-Mar)</span>
                                <span class="text-lg font-extrabold text-green-600">$1.000.000</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- GRUPO MONTAJE/DESMONTAJE (No excluyente del arriendo principal, se suma como adicional si se necesita) -->
                     <div class="p-4 bg-yellow-50 rounded-lg border border-yellow-200">
                        <h3 class="font-black text-lg mb-3 flex items-center text-yellow-700">
                            <i data-lucide="tool" class="w-5 h-5 mr-2"></i> Montaje / Desmontaje
                        </h3>
                        <div class="selectable-item flex items-center p-3">
                            <input id="arriendo_montaje_1" type="checkbox" name="adicional_arriendo" value="1750000" class="text-yellow-600 focus:ring-yellow-500 mr-3 w-5 h-5" onchange="calculateTotal()">
                            <label for="arriendo_montaje_1" class="w-full font-semibold text-gray-800 p-2 border border-transparent rounded-lg flex justify-between items-center">
                                <span class="flex-1">Montaje / Desmontaje PISO -1 (8:00 - 18:00 hrs)</span>
                                <span class="text-lg font-extrabold text-gray-700">$1.750.000</span>
                            </label>
                        </div>
                        <div class="selectable-item flex items-center p-3">
                            <input id="arriendo_montaje_2" type="checkbox" name="adicional_arriendo" value="750000" class="text-yellow-600 focus:ring-yellow-500 mr-3 w-5 h-5" onchange="calculateTotal()">
                            <label for="arriendo_montaje_2" class="w-full font-semibold text-gray-800 p-2 border border-transparent rounded-lg flex justify-between items-center">
                                <span class="flex-1">Montaje / Desmontaje PISO -6 (8:00 - 18:00 hrs)</span>
                                <span class="text-lg font-extrabold text-gray-700">$750.000</span>
                            </label>
                        </div>
                    </div>

                    <!-- GRUPO SESIONES FOTOGRÁFICAS (Excluyente del Arriendo Evento) -->
                    <div id="sesiones" class="p-4 bg-orange-50 rounded-lg border border-orange-200">
                        <h3 class="font-black text-lg mb-3 flex items-center text-orange-700">
                            <i data-lucide="camera" class="w-5 h-5 mr-2"></i> Sesiones Fotográficas y Grabaciones
                        </h3>
                        <!-- Opción 5: Sesión Fotográfica -->
                        <div class="selectable-item flex items-center p-3">
                            <input id="arriendo_5" type="radio" name="arriendo" value="400000" class="text-orange-600 focus:ring-orange-500 mr-3 w-5 h-5" onchange="calculateTotal()">
                            <label for="arriendo_5" class="w-full font-semibold text-gray-800 p-2 border border-transparent rounded-lg flex justify-between items-center">
                                <span class="flex-1">Sesión Fotográfica Comercial (4 hrs)</span>
                                <span class="text-lg font-extrabold text-red-600">$400.000</span>
                            </label>
                        </div>
                        <!-- Opción 6: Grabación Audiovisual -->
                        <div class="selectable-item flex items-center p-3">
                            <input id="arriendo_6" type="radio" name="arriendo" value="600000" class="text-orange-600 focus:ring-orange-500 mr-3 w-5 h-5" onchange="calculateTotal()">
                            <label for="arriendo_6" class="w-full font-semibold text-gray-800 p-2 border border-transparent rounded-lg flex justify-between items-center">
                                <span class="flex-1">Grabación Audiovisual/Videoclip (6 hrs)</span>
                                <span class="text-lg font-extrabold text-red-600">$600.000</span>
                            </label>
                        </div>
                        <!-- Opción 7: Jornada Completa (Premium) -->
                        <div class="selectable-item flex items-center p-3 bg-yellow-100/50">
                            <input id="arriendo_7" type="radio" name="arriendo" value="900000" class="text-orange-600 focus:ring-orange-500 mr-3 w-5 h-5" onchange="calculateTotal()">
                            <label for="arriendo_7" class="w-full font-semibold text-gray-800 p-2 border border-transparent rounded-lg flex justify-between items-center">
                                <span class="flex-1 font-black text-yellow-700">JORNADA COMPLETA (Foto + Video - 10 hrs)</span>
                                <span class="text-lg font-black text-yellow-700">$900.000</span>
                            </label>
                        </div>
                    </div>

                </div>

            </section>

            <!-- SECCIÓN III: STAFF OPERATIVO (Checkboxes) -->
            <section id="staff" class="content-card">
                <h2 class="text-2xl section-title">III. Staff Operativo y Logística</h2>
                <p class="text-gray-600 mb-4">Seleccione el personal requerido para su evento. Valores por jornada estándar (10 hrs, a menos que se indique lo contrario).</p>
                
                <div class="space-y-4">
                    <div class="p-4 bg-gray-50 rounded-lg border border-gray-200">
                         <!-- Opción 8: Productor en Terreno (Obligatorio) -->
                        <div class="selectable-item flex items-center p-3">
                            <input id="staff_1" type="checkbox" name="adicional" value="250000" class="text-indigo-600 focus:ring-indigo-500 mr-3 w-5 h-5" onchange="calculateTotal()">
                            <label for="staff_1" class="w-full font-semibold text-gray-800 p-2 border border-transparent rounded-lg flex justify-between items-center">
                                <span class="flex-1 text-indigo-700 font-black">Productor en Terreno (Obligatorio)</span>
                                <span class="text-lg font-extrabold text-indigo-700">$250.000</span>
                            </label>
                        </div>
                        <!-- Opción 9: Productor General -->
                        <div class="selectable-item flex items-center p-3">
                            <input id="staff_2" type="checkbox" name="adicional" value="350000" class="text-indigo-600 focus:ring-indigo-500 mr-3 w-5 h-5" onchange="calculateTotal()">
                            <label for="staff_2" class="w-full font-semibold text-gray-800 p-2 border border-transparent rounded-lg flex justify-between items-center">
                                <span class="flex-1">Productor General del Evento (Jornada)</span>
                                <span class="text-lg font-extrabold text-gray-700">$350.000</span>
                            </label>
                        </div>
                         <!-- Opción 10: Guardia de Seguridad -->
                        <div class="selectable-item flex items-center p-3">
                            <input id="staff_3" type="checkbox" name="adicional" value="90000" class="text-indigo-600 focus:ring-indigo-500 mr-3 w-5 h-5" onchange="calculateTotal()">
                            <label for="staff_3" class="w-full font-semibold text-gray-800 p-2 border border-transparent rounded-lg flex justify-between items-center">
                                <span class="flex-1">Guardia de Seguridad (10 hrs)</span>
                                <span class="text-lg font-extrabold text-gray-700">$90.000</span>
                            </label>
                        </div>
                         <!-- Opción 11: Personal de Aseo -->
                        <div class="selectable-item flex items-center p-3">
                            <input id="staff_4" type="checkbox" name="adicional" value="60000" class="text-indigo-600 focus:ring-indigo-500 mr-3 w-5 h-5" onchange="calculateTotal()">
                            <label for="staff_4" class="w-full font-semibold text-gray-800 p-2 border border-transparent rounded-lg flex justify-between items-center">
                                <span class="flex-1">Personal de Aseo (6 hrs, Durante Evento)</span>
                                <span class="text-lg font-extrabold text-gray-700">$60.000</span>
                            </label>
                        </div>
                         <!-- Opción 12: Staff de Apoyo -->
                        <div class="selectable-item flex items-center p-3">
                            <input id="staff_5" type="checkbox" name="adicional" value="45000" class="text-indigo-600 focus:ring-indigo-500 mr-3 w-5 h-5" onchange="calculateTotal()">
                            <label for="staff_5" class="w-full font-semibold text-gray-800 p-2 border border-transparent rounded-lg flex justify-between items-center">
                                <span class="flex-1">Staff de Apoyo / Anfitriones (Media Jornada)</span>
                                <span class="text-lg font-extrabold text-gray-700">$45.000</span>
                            </label>
                        </div>
                    </div>
                </div>
            </section>

             <!-- SECCIÓN IV: SERVICIOS TÉCNICOS Y COMPLEMENTARIOS (Checkboxes) -->
            <section id="tecnicos" class="content-card">
                <h2 class="text-2xl section-title">IV. Servicios Técnicos y Logísticos</h2>
                <p class="text-gray-600 mb-4">Equipamiento adicional disponible para su producción.</p>
                
                <div class="space-y-4">
                    <div class="p-4 bg-gray-50 rounded-lg border border-gray-200">
                         <!-- Opción 13: Proyección Base -->
                        <div class="selectable-item flex items-center p-3">
                            <input id="tech_1" type="checkbox" name="adicional" value="180000" class="text-green-600 focus:ring-green-500 mr-3 w-5 h-5" onchange="calculateTotal()">
                            <label for="tech_1" class="w-full font-semibold text-gray-800 p-2 border border-transparent rounded-lg flex justify-between items-center">
                                <span class="flex-1">Sistema de Proyección Base (Proyector + Pantalla)</span>
                                <span class="text-lg font-extrabold text-green-700">$180.000</span>
                            </label>
                        </div>
                        <!-- Opción 14: Micrófono Inalámbrico -->
                        <div class="selectable-item flex items-center p-3">
                            <input id="tech_2" type="checkbox" name="adicional" value="35000" class="text-green-600 focus:ring-green-500 mr-3 w-5 h-5" onchange="calculateTotal()">
                            <label for="tech_2" class="w-full font-semibold text-gray-800 p-2 border border-transparent rounded-lg flex justify-between items-center">
                                <span class="flex-1">Micrófono Inalámbrico Shure (Unidad/Día)</span>
                                <span class="text-lg font-extrabold text-gray-700">$35.000</span>
                            </label>
                        </div>
                         <!-- Opción 15: Generador Eléctrico -->
                        <div class="selectable-item flex items-center p-3">
                            <input id="tech_3" type="checkbox" name="adicional" value="220000" class="text-green-600 focus:ring-green-500 mr-3 w-5 h-5" onchange="calculateTotal()">
                            <label for="tech_3" class="w-full font-semibold text-gray-800 p-2 border border-transparent rounded-lg flex justify-between items-center">
                                <span class="flex-1">Generador Eléctrico Silencioso (10 KVA / Día)</span>
                                <span class="text-lg font-extrabold text-gray-700">$220.000</span>
                            </label>
                        </div>
                         <!-- Opción 16: Decoración Base -->
                        <div class="selectable-item flex items-center p-3">
                            <input id="tech_4" type="checkbox" name="adicional" value="120000" class="text-green-600 focus:ring-green-500 mr-3 w-5 h-5" onchange="calculateTotal()">
                            <label for="tech_4" class="w-full font-semibold text-gray-800 p-2 border border-transparent rounded-lg flex justify-between items-center">
                                <span class="flex-1">Decoración Base con Follaje (Fijo)</span>
                                <span class="text-lg font-extrabold text-gray-700">$120.000</span>
                            </label>
                        </div>
                         <!-- Opción 17: Señalética -->
                        <div class="selectable-item flex items-center p-3">
                            <input id="tech_5" type="checkbox" name="adicional" value="50000" class="text-green-600 focus:ring-green-500 mr-3 w-5 h-5" onchange="calculateTotal()">
                            <label for="tech_5" class="w-full font-semibold text-gray-800 p-2 border border-transparent rounded-lg flex justify-between items-center">
                                <span class="flex-1">Señalética Personalizada (Branding, Fijo)</span>
                                <span class="text-lg font-extrabold text-gray-700">$50.000</span>
                            </label>
                        </div>
                    </div>
                </div>
            </section>

            <!-- SECCIÓN V: CONDICIONES (Informativa) -->
            <section class="content-card">
                 <h2 class="text-2xl section-title">V. Condiciones Comerciales (Informativas)</h2>
                <div class="p-4 bg-gray-50 rounded-lg border border-gray-200">
                    <p class="font-black text-gray-800 mb-2">Garantía de Uso Reembolsable</p>
                    <p class="text-2xl font-black accent-color">$300.000 CLP</p>
                    <p class="text-sm text-gray-600 mt-2">Este monto es un depósito reembolsable requerido para cubrir posibles daños o imprevistos. No se incluye en el total de la cotización, pero es obligatorio para la reserva.</p>
                </div>
            </section>

        </div>
        
        <!-- COLUMNA LATERAL (Resumen de Cotización) -->
        <div class="lg:col-span-1">
            <div class="sticky top-28 bg-white p-6 rounded-xl shadow-lg border-t-4 border-yellow-500 space-y-6">
                
                <h3 class="text-xl font-black text-gray-800 flex items-center border-b pb-3">
                    <i data-lucide="calculator" class="w-5 h-5 mr-2 text-yellow-600"></i>
                    RESUMEN DE COTIZACIÓN
                </h3>
                
                <div id="summary-details" class="space-y-2 text-sm">
                    <p class="text-gray-500">Aún no ha seleccionado ningún servicio principal.</p>
                </div>

                <!-- Totales -->
                <div class="pt-4 border-t border-gray-200 space-y-3">
                    <div class="flex justify-between items-center">
                        <span class="font-semibold text-gray-600">Subtotal Neto:</span>
                        <span id="subtotal_neto" class="text-lg font-extrabold text-gray-800">$0 CLP</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="font-semibold text-gray-600">IVA (19%):</span>
                        <span id="iva_monto" class="text-lg font-extrabold text-gray-800">$0 CLP</span>
                    </div>
                    <div class="flex justify-between items-center bg-yellow-100 p-3 rounded-lg">
                        <span class="font-black text-xl text-yellow-700">TOTAL FINAL (Bruto):</span>
                        <span id="total_bruto" class="text-2xl font-black text-yellow-700">$0 CLP</span>
                    </div>
                </div>

                <!-- Acción de Copia -->
                <button onclick="copyTotal()" class="w-full py-3 bg-yellow-500 text-white font-bold rounded-lg shadow-md hover:bg-yellow-600 transition duration-150 flex items-center justify-center">
                    <i data-lucide="copy" class="w-5 h-5 mr-2"></i>
                    Copiar Detalle y Total
                </button>
                <div id="copy-message" class="text-center text-sm text-green-600 font-semibold hidden">
                    ¡Detalle y Total copiado al portapapeles!
                </div>
                
                <!-- Recordatorio de Garantía -->
                <div class="mt-4 p-3 bg-red-50 text-red-700 rounded-lg text-xs font-medium flex items-center">
                     <i data-lucide="alert-triangle" class="w-4 h-4 mr-2 flex-shrink-0"></i>
                     **Garantía de Uso ($300.000)** se cobra aparte y se reembolsa post-evento.
                </div>

            </div>
        </div>
    </div>

    <script>
        // Función de formato de moneda (CLP)
        const formatCLP = (amount) => {
            return new Intl.NumberFormat('es-CL', { 
                style: 'currency', 
                currency: 'CLP',
                minimumFractionDigits: 0
            }).format(amount).replace('$', '$ '); // Añadir espacio después del símbolo
        };

        // IVA Rate (19%)
        const IVA_RATE = 0.19;

        // Mapeo de valores para el resumen (Para mostrar texto claro en el resumen)
        const itemMap = {
            // Arriendo Evento
            '3500000': 'Arriendo PISO -1 (Mié-Vie)',
            '3000000': 'Arriendo PISO -1 (Sáb-Mar)',
            '1500000': 'Arriendo PISO -6 (Mié-Sáb)',
            '1000000': 'Arriendo PISO -6 (Dom-Mar)',
            // Sesiones Fotográficas
            '400000': 'Sesión Fotográfica (4 hrs)',
            '600000': 'Grabación Audiovisual (6 hrs)',
            '900000': 'Jornada Completa (10 hrs)',
            // Adicionales Arriendo (Montaje)
            '1750000': 'Montaje/Desmontaje PISO -1',
            '750000': 'Montaje/Desmontaje PISO -6',
            // Staff Operativo
            '250000': 'Productor en Terreno (Obligatorio)',
            '350000': 'Productor General del Evento',
            '90000': 'Guardia de Seguridad (10 hrs)',
            '60000': 'Personal de Aseo (6 hrs)',
            '45000': 'Staff de Apoyo / Anfitriones',
            // Servicios Técnicos
            '180000': 'Sistema de Proyección Base',
            '35000': 'Micrófono Inalámbrico Shure',
            '220000': 'Generador Eléctrico Silencioso',
            '120000': 'Decoración Base con Follaje',
            '50000': 'Señalética Personalizada',
        };


        /**
         * Calcula el total de la cotización sumando Arriendo Principal, Adicionales de Arriendo y Adicionales
         */
        function calculateTotal() {
            let subtotalNeto = 0;
            const selectedItems = [];

            // 1. Obtener el valor del Arriendo Principal (Radio buttons 'arriendo')
            const selectedArriendo = document.querySelector('input[name="arriendo"]:checked');
            if (selectedArriendo) {
                const value = parseInt(selectedArriendo.value);
                subtotalNeto += value;
                selectedItems.push({
                    name: itemMap[selectedArriendo.value] || 'Arriendo Principal',
                    value: value
                });
            }

            // 2. Obtener los Adicionales de Arriendo (Checkboxes 'adicional_arriendo' - Montaje)
            const additionalArriendo = document.querySelectorAll('input[name="adicional_arriendo"]:checked');
            additionalArriendo.forEach(checkbox => {
                const value = parseInt(checkbox.value);
                subtotalNeto += value;
                selectedItems.push({
                    name: itemMap[checkbox.value] || 'Adicional Arriendo',
                    value: value
                });
            });

            // 3. Obtener los servicios adicionales (Checkboxes 'adicional')
            const additionalServices = document.querySelectorAll('input[name="adicional"]:checked');
            additionalServices.forEach(checkbox => {
                const value = parseInt(checkbox.value);
                subtotalNeto += value;
                 selectedItems.push({
                    name: itemMap[checkbox.value] || 'Servicio Adicional',
                    value: value
                });
            });


            // Cálculo del IVA y Total Bruto
            const ivaMonto = subtotalNeto * IVA_RATE;
            const totalBruto = subtotalNeto + ivaMonto;

            // Actualizar la interfaz de resumen
            updateSummary(subtotalNeto, ivaMonto, totalBruto, selectedItems);
        }

        /**
         * Actualiza el panel de resumen con los totales y la lista de servicios.
         */
        function updateSummary(neto, iva, bruto, items) {
            document.getElementById('subtotal_neto').textContent = formatCLP(neto);
            document.getElementById('iva_monto').textContent = formatCLP(iva);
            document.getElementById('total_bruto').textContent = formatCLP(bruto);

            const summaryDetails = document.getElementById('summary-details');
            summaryDetails.innerHTML = '';

            if (items.length === 0) {
                summaryDetails.innerHTML = '<p class="text-gray-500">Aún no ha seleccionado ningún servicio principal.</p>';
                return;
            }

            // Separar Arriendo y Adicionales para mejor lectura
            let htmlContent = '<p class="font-black text-gray-700 mb-2 mt-2 flex items-center"><i data-lucide="building-2" class="w-4 h-4 mr-2 text-yellow-500"></i> ARRIENDO PRINCIPAL & MONTAJE</p>';
            
            const mainArriendo = document.querySelector('input[name="arriendo"]:checked');
            
            if (mainArriendo) {
                 const mainItem = items.find(item => item.value === parseInt(mainArriendo.value));
                if (mainItem) {
                    htmlContent += `
                        <div class="flex justify-between items-center border-b border-dashed pb-1">
                            <span class="text-sm font-bold text-gray-900">${mainItem.name}</span>
                            <span class="text-sm font-bold text-red-600">${formatCLP(mainItem.value)}</span>
                        </div>`;
                }
            } else {
                 htmlContent += '<p class="text-sm text-red-500 pb-2">❌ Falta seleccionar un Arriendo Principal.</p>';
            }

            // Mostrar Montajes/Desmontajes
            const additionalArriendo = items.filter(item => ['1750000', '750000'].includes(item.value.toString()));
            additionalArriendo.forEach(item => {
                 htmlContent += `
                    <div class="flex justify-between items-center border-b border-dashed pb-1 pl-2">
                        <span class="text-xs text-gray-600">${item.name}</span>
                        <span class="text-xs text-gray-600">${formatCLP(item.value)}</span>
                    </div>`;
            });


            // Mostrar Staff y Técnicos
            const additionalServices = items.filter(item => !['3500000', '3000000', '1500000', '1000000', '400000', '600000', '900000', '1750000', '750000'].includes(item.value.toString()));
            
            if (additionalServices.length > 0) {
                 htmlContent += '<p class="font-black text-gray-700 mb-2 mt-4 flex items-center"><i data-lucide="package" class="w-4 h-4 mr-2 text-yellow-500"></i> SERVICIOS ADICIONALES</p>';
                 additionalServices.forEach(item => {
                    htmlContent += `
                        <div class="flex justify-between items-center border-b border-dashed pb-1">
                            <span class="text-sm text-gray-700">${item.name}</span>
                            <span class="text-sm text-gray-700">${formatCLP(item.value)}</span>
                        </div>`;
                });
            }
            
            summaryDetails.innerHTML = htmlContent;

            // Vuelve a crear los iconos de Lucide en el resumen
            lucide.createIcons();
        }

        /**
         * Función para hacer scroll suave a la sección
         */
        function scrollToSection(sectionId) {
            const element = document.getElementById(sectionId);
            if (element) {
                element.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        /**
         * Función para copiar el detalle de la cotización al portapapeles
         */
        function copyTotal() {
            // 1. Obtener datos de planificación
            const eventName = document.getElementById('event_name').value.trim() || 'Sin Nombre';
            const eventType = document.getElementById('event_type').value;
            const attendees = document.getElementById('attendees').value.trim() || 'No especificado';
            const duration = document.getElementById('duration').value.trim() || 'No especificado';
            const totalBrutoText = document.getElementById('total_bruto').textContent;
            const subtotalNetoText = document.getElementById('subtotal_neto').textContent;
            const ivaMontoText = document.getElementById('iva_monto').textContent;
            
            // 2. Obtener lista de servicios seleccionados para el detalle
            let servicesDetail = '';
            
            const summaryDetailElements = document.getElementById('summary-details').children;
            let currentCategory = '';
            
            Array.from(summaryDetailElements).forEach(el => {
                if (el.tagName === 'P' && el.classList.contains('font-black')) {
                    // Es un título de categoría
                    currentCategory = el.textContent.trim().replace(/[\u200B\u200C\u200D\u200E\u200F]/g, ''); // Limpiar caracteres invisibles
                    servicesDetail += `\n${currentCategory}:\n`;
                } else if (el.tagName === 'DIV') {
                    // Es un item de servicio (nombre y precio)
                    const name = el.children[0].textContent.trim();
                    const value = el.children[1].textContent.trim();
                    servicesDetail += `  - ${name}: ${value}\n`;
                }
            });

            // 3. Construir el texto final para copiar
            const textToCopy = 
`--- DETALLE DE COTIZACIÓN - EDIFICIO GIBRALTAR ---

[PLANIFICACIÓN DEL EVENTO]
- Nombre del Proyecto: ${eventName}
- Tipo de Evento: ${eventType}
- Asistentes Estimados: ${attendees} personas
- Duración Estimada: ${duration} horas

[SERVICIOS SELECCIONADOS (Neto)]
${servicesDetail}

[RESUMEN DE COSTOS]
- Subtotal Neto: ${subtotalNetoText}
- IVA (19%): ${ivaMontoText}
- TOTAL FINAL (Bruto): ${totalBrutoText}
---
*Nota: La Garantía de Uso ($300.000) se cobra por separado.`;


            // 4. Copiar al portapapeles
            const tempInput = document.createElement('textarea');
            tempInput.value = textToCopy;
            document.body.appendChild(tempInput);
            tempInput.select();
            document.execCommand('copy');
            document.body.removeChild(tempInput);

            const msg = document.getElementById('copy-message');
            msg.classList.remove('hidden');
            setTimeout(() => {
                msg.classList.add('hidden');
            }, 2000);
        }

        // Inicializar
        window.onload = function() {
            lucide.createIcons();
            calculateTotal();
        };
    </script>
</body>
</html>
